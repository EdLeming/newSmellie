<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sepia.usb &mdash; SMELLIE  documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="SMELLIE  documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SMELLIE  documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sepia.usb</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">exceptions</span> <span class="kn">import</span> <span class="n">decode_exceptions</span>
<span class="kn">from</span> <span class="nn">_sepia</span> <span class="kn">import</span> <span class="n">string_buffer</span><span class="p">,</span> <span class="n">dll</span>
<span class="kn">import</span> <span class="nn">ctypes</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Device Communication Functions (USB)</span>
<span class="sd">The functions of the USB group handle the PQ Laser Device as an USB device. Besides opening and closing, they provide information on the device and help to identify the desired instance if there is more than one PQ Laser Device connected to the PC.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="nd">@decode_exceptions</span>
<div class="viewcode-block" id="get_dll_version"><a class="viewcode-back" href="../../sepia.html#sepia.usb.get_dll_version">[docs]</a><span class="k">def</span> <span class="nf">get_dll_version</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;get_dll_version()</span>

<span class="sd">    String representation of current dll version. </span>
<span class="sd">    </span>
<span class="sd">    :returns: DLL version</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">str_buff</span> <span class="o">=</span> <span class="n">string_buffer</span><span class="p">()</span>
    <span class="n">dll</span><span class="o">.</span><span class="n">SEPIA2_LIB_GetVersion</span><span class="p">(</span><span class="n">str_buff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">str_buff</span>
</div>
<span class="nd">@decode_exceptions</span>    
<div class="viewcode-block" id="open_usb_device"><a class="viewcode-back" href="../../sepia.html#sepia.usb.open_usb_device">[docs]</a><span class="k">def</span> <span class="nf">open_usb_device</span><span class="p">(</span><span class="n">dev_id</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;open_usb_device(dev_id)</span>
<span class="sd">    Open exclusive access to the device on USB channel dev_id</span>

<span class="sd">    :param dev_id: the sepia device number (ordered from 0)</span>

<span class="sd">    :returns: the product model and serial number</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">check_channel</span><span class="p">(</span><span class="n">dev_id</span><span class="p">,</span> <span class="s">&quot;open_device&quot;</span><span class="p">)</span>
    <span class="n">product_model</span> <span class="o">=</span> <span class="n">string_buffer</span><span class="p">()</span>
    <span class="n">serial_number</span> <span class="o">=</span> <span class="n">string_buffer</span><span class="p">()</span>
    <span class="n">dll</span><span class="o">.</span><span class="n">SEPIA2_USB_OpenDevice</span><span class="p">(</span><span class="n">dev_id</span><span class="p">,</span> 
                              <span class="n">product_model</span><span class="p">,</span> <span class="n">serial_number</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">product_model</span><span class="p">,</span> <span class="n">serial_number</span>
</div>
<span class="nd">@decode_exceptions</span>    
<div class="viewcode-block" id="close_usb_device"><a class="viewcode-back" href="../../sepia.html#sepia.usb.close_usb_device">[docs]</a><span class="k">def</span> <span class="nf">close_usb_device</span><span class="p">(</span><span class="n">dev_id</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;close_usb_device(dev_id)</span>
<span class="sd">    Terminate exclusive access to device on dev_id</span>
<span class="sd">    </span>
<span class="sd">    :param dev_id: the sepia device number (ordered from 0)</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="n">check_channel</span><span class="p">(</span><span class="n">dev_id</span><span class="p">,</span> <span class="s">&quot;close_device&quot;</span><span class="p">)</span>
    <span class="n">dll</span><span class="o">.</span><span class="n">SEPIA2_USB_CloseDevice</span><span class="p">(</span><span class="n">dev_id</span><span class="p">)</span>
</div>
<span class="nd">@decode_exceptions</span>
<div class="viewcode-block" id="get_state_descriptor"><a class="viewcode-back" href="../../sepia.html#sepia.usb.get_state_descriptor">[docs]</a><span class="k">def</span> <span class="nf">get_state_descriptor</span><span class="p">(</span><span class="n">dev_id</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;get_state_descriptor(dev_id)</span>
<span class="sd">    :param dev_id: the sepia device number (ordered from 0)</span>

<span class="sd">    :returns: concatenated string descriptors of USB device</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">check_channel</span><span class="p">(</span><span class="n">dev_id</span><span class="p">,</span> <span class="s">&quot;get_state_descriptor&quot;</span><span class="p">)</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">string_buffer</span><span class="p">()</span>
    <span class="n">dll</span><span class="o">.</span><span class="n">SEPIA2_USB_GetStrDescriptor</span><span class="p">(</span><span class="n">dev_id</span><span class="p">,</span> <span class="n">desc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">desc</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Christopher Jones, Jeff Lidgard, Luca Cavalli, Krishanu Majumdar, Jack Dunger.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.2</a>
      
    </div>

    

    
  </body>
</html>